# Bundle Analyzer æ’ä»¶å¢å¼ºå»ºè®®

æœ¬æ–‡æ¡£è®°å½•äº† Bundle Analyzer æ’ä»¶å¯ä»¥æ–°å¢çš„ç»Ÿè®¡ç»´åº¦,åŒ…æ‹¬è¯¦ç»†è¯´æ˜ã€å®ç°å¯è¡Œæ€§å’Œæ€§èƒ½å½±å“è¯„ä¼°ã€‚

## ç›®å½•
- [é«˜å¯è¡Œæ€§ + ä½æ€§èƒ½å½±å“](#é«˜å¯è¡Œæ€§--ä½æ€§èƒ½å½±å“)
- [é«˜å¯è¡Œæ€§ + ä¸­ç­‰æ€§èƒ½å½±å“](#é«˜å¯è¡Œæ€§--ä¸­ç­‰æ€§èƒ½å½±å“)
- [ä¸­ç­‰å¯è¡Œæ€§ + è¾ƒé«˜æ€§èƒ½å½±å“](#ä¸­ç­‰å¯è¡Œæ€§--è¾ƒé«˜æ€§èƒ½å½±å“)
- [ä½å¯è¡Œæ€§æˆ–ä¾èµ–å¤–éƒ¨æ•°æ®](#ä½å¯è¡Œæ€§æˆ–ä¾èµ–å¤–éƒ¨æ•°æ®)
- [æ¨èå®ç°æ¸…å•](#æ¨èå®ç°æ¸…å•)

---

## é«˜å¯è¡Œæ€§ + ä½æ€§èƒ½å½±å“

è¿™äº›åŠŸèƒ½ç¡®å®šæ€§å¼ºã€æ˜“äºå®ç°ã€å¯¹æ„å»ºæ€§èƒ½å‡ ä¹æ— å½±å“,å»ºè®®ä¼˜å…ˆå®ç°ã€‚

### 1. æ–‡ä»¶ç±»å‹åˆ†å¸ƒç»Ÿè®¡ â­â­â­â­â­

**åŠŸèƒ½è¯´æ˜**:
ç»Ÿè®¡æ‰“åŒ…äº§ç‰©ä¸­ä¸åŒæ–‡ä»¶ç±»å‹çš„æ•°é‡ã€å¤§å°å’Œå æ¯”ã€‚

**ä¸ºä»€ä¹ˆéœ€è¦**:
- å¿«é€Ÿäº†è§£èµ„æºç»„æˆ(JavaScriptã€CSSã€å›¾ç‰‡ã€å­—ä½“ç­‰)
- è¯†åˆ«å“ªç§èµ„æºå ç”¨æœ€å¤šç©ºé—´
- å‘ç°å¼‚å¸¸æƒ…å†µ(æ¯”å¦‚å›¾ç‰‡èµ„æºè¿‡å¤§ã€å­—ä½“æ–‡ä»¶è¿‡å¤š)

**æ•°æ®ç¤ºä¾‹**:
```json
{
  "fileTypeStats": [
    {
      "type": "JavaScript",
      "extensions": [".js", ".mjs"],
      "count": 15,
      "totalSize": 524288,      // 512KB
      "gzipSize": 157286,       // 150KB
      "percentage": 65.5
    },
    {
      "type": "CSS",
      "extensions": [".css"],
      "count": 3,
      "totalSize": 102400,      // 100KB
      "gzipSize": 20480,        // 20KB
      "percentage": 12.8
    },
    {
      "type": "Image",
      "extensions": [".png", ".jpg", ".svg", ".webp"],
      "count": 25,
      "totalSize": 163840,      // 160KB
      "percentage": 20.5
    }
  ]
}
```

**å®ç°æ–¹æ¡ˆ**:
- åœ¨ `collect_assets()` ä¸­,æ ¹æ®æ–‡ä»¶æ‰©å±•ååˆ†ç±»
- æŒ‰ç±»å‹ç´¯åŠ å¤§å°ã€è®¡æ•°
- è®¡ç®—ç™¾åˆ†æ¯”

**æ€§èƒ½å½±å“**: âš¡ å‡ ä¹ä¸º 0 (< 5ms)
- åªæ˜¯å­—ç¬¦ä¸²è§£æå’Œç´¯åŠ æ“ä½œ

**å®ç°éš¾åº¦**: ğŸŸ¢ ç®€å•

---

### 2. æºç  vs ä¾èµ–æ¯”ä¾‹åˆ†æ â­â­â­â­â­

**åŠŸèƒ½è¯´æ˜**:
åŒºåˆ†å¹¶ç»Ÿè®¡ä¸šåŠ¡ä»£ç (é¡¹ç›®æºç )å’Œç¬¬ä¸‰æ–¹ä¾èµ–ä»£ç çš„å æ¯”ã€‚

**ä¸ºä»€ä¹ˆéœ€è¦**:
- è¯„ä¼°ä»£ç è†¨èƒ€ç¨‹åº¦(å¦‚æœä¾èµ–å æ¯”è¿‡é«˜,å¯èƒ½éœ€è¦ä¼˜åŒ–)
- è¯†åˆ«æ˜¯å¦å¼•å…¥äº†è¿‡é‡çš„ç¬¬ä¸‰æ–¹åº“
- å¸®åŠ©å†³ç­–æ˜¯å¦éœ€è¦æ›¿æ¢æ›´è½»é‡çš„ä¾èµ–

**æ•°æ®ç¤ºä¾‹**:
```json
{
  "codeDistribution": {
    "sourceCode": {
      "size": 204800,           // 200KB (ä¸šåŠ¡ä»£ç )
      "moduleCount": 85,
      "percentage": 25.6
    },
    "dependencies": {
      "size": 595968,           // 582KB (ä¾èµ–ä»£ç )
      "moduleCount": 156,
      "percentage": 74.4
    },
    "ratio": 0.34               // æºç /ä¾èµ–æ¯”ä¾‹
  }
}
```

**åˆ¤æ–­æ ‡å‡†**:
- æ¯”ä¾‹ > 0.5: ä¸šåŠ¡ä»£ç ä¸ºä¸»,å¥åº·çŠ¶æ€
- æ¯”ä¾‹ 0.2-0.5: æ­£å¸¸èŒƒå›´,ä¾èµ–è¾ƒå¤š
- æ¯”ä¾‹ < 0.2: ä¾èµ–è¿‡é‡,éœ€è¦ä¼˜åŒ–

**å®ç°æ–¹æ¡ˆ**:
- åˆ©ç”¨ç°æœ‰çš„ `Module.is_node_module` å­—æ®µ
- éå† modules,æŒ‰ `is_node_module` åˆ†ç»„ç»Ÿè®¡

**æ€§èƒ½å½±å“**: âš¡ å‡ ä¹ä¸º 0 (< 5ms)

**å®ç°éš¾åº¦**: ğŸŸ¢ éå¸¸ç®€å•

---

### 3. Chunk åˆ†ç»„ç»Ÿè®¡ â­â­â­â­â­

**åŠŸèƒ½è¯´æ˜**:
æŒ‰ chunk çš„ç±»å‹(å…¥å£ã€è¿è¡Œæ—¶ã€å¼‚æ­¥ã€vendor ç­‰)è¿›è¡Œåˆ†ç»„ç»Ÿè®¡ã€‚

**ä¸ºä»€ä¹ˆéœ€è¦**:
- äº†è§£ä»£ç åˆ†å‰²æ•ˆæœ
- è¯†åˆ«é¦–å±åŠ è½½çš„ä»£ç é‡(entry + initial chunks)
- è¯„ä¼°æ‡’åŠ è½½çš„ä½¿ç”¨æƒ…å†µ(async chunks)
- æ£€æŸ¥è¿è¡Œæ—¶ä»£ç çš„å¤§å°

**Chunk ç±»å‹è¯´æ˜**:
- **Entry Chunk**: åº”ç”¨å…¥å£ç‚¹,é¦–æ¬¡åŠ è½½å¿…éœ€
- **Initial Chunk**: åˆå§‹åŠ è½½çš„ chunk,ä¹Ÿæ˜¯é¦–å±å¿…éœ€
- **Async Chunk**: æ‡’åŠ è½½/åŠ¨æ€å¯¼å…¥çš„ chunk,å¯å»¶è¿ŸåŠ è½½
- **Runtime Chunk**: webpack/rspack è¿è¡Œæ—¶ä»£ç 
- **Vendor Chunk**: ç¬¬ä¸‰æ–¹åº“ä»£ç (é€šè¿‡ splitChunks é…ç½®æ‹†åˆ†)

**æ•°æ®ç¤ºä¾‹**:
```json
{
  "chunkGroups": {
    "entry": {
      "count": 2,
      "totalSize": 102400,      // 100KB
      "chunks": ["main", "admin"]
    },
    "initial": {
      "count": 3,
      "totalSize": 153600,      // 150KB
      "chunks": ["main", "vendor", "common"]
    },
    "async": {
      "count": 8,
      "totalSize": 307200,      // 300KB
      "chunks": ["lazy-route-1", "lazy-route-2", ...]
    },
    "runtime": {
      "count": 1,
      "totalSize": 10240,       // 10KB
      "chunks": ["runtime"]
    }
  },
  "insights": {
    "firstLoadSize": 153600,    // initial chunks æ€»å¤§å°
    "lazyLoadSize": 307200      // async chunks æ€»å¤§å°
  }
}
```

**å®ç°æ–¹æ¡ˆ**:
- åˆ©ç”¨ç°æœ‰ Chunk ç»“æ„çš„å­—æ®µ:
  - `entry`: æ˜¯å¦å…¥å£ chunk
  - `initial`: æ˜¯å¦åˆå§‹ chunk
  - `async_chunks`: æ˜¯å¦å¼‚æ­¥ chunk
  - `runtime`: æ˜¯å¦è¿è¡Œæ—¶ chunk
- åœ¨ `collect_chunks()` åæ·»åŠ åˆ†ç»„é€»è¾‘

**æ€§èƒ½å½±å“**: âš¡ å‡ ä¹ä¸º 0 (< 5ms)

**å®ç°éš¾åº¦**: ğŸŸ¢ ç®€å•

---

### 4. å‹ç¼©ç‡ç»Ÿè®¡ â­â­â­â­â­

**åŠŸèƒ½è¯´æ˜**:
è®¡ç®—æ¯ä¸ªæ–‡ä»¶çš„å‹ç¼©æ•ˆç‡,è¯†åˆ«å·²å‹ç¼©æˆ–éš¾ä»¥å‹ç¼©çš„èµ„æºã€‚

**ä¸ºä»€ä¹ˆéœ€è¦**:
- è¯†åˆ«å“ªäº›æ–‡ä»¶å·²ç»è¢«å‹ç¼©è¿‡(å¦‚å›¾ç‰‡ã€è§†é¢‘),æ— éœ€å†å‹ç¼©
- å‘ç°å‹ç¼©ç‡ä½çš„æ–‡ä»¶,å¯èƒ½æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶
- è¯„ä¼° gzip/brotli çš„å‹ç¼©æ•ˆæœ

**å‹ç¼©ç‡è®¡ç®—**:
```
å‹ç¼©ç‡ = (åŸå§‹å¤§å° - å‹ç¼©åå¤§å°) / åŸå§‹å¤§å° Ã— 100%
```

**æ•°æ®ç¤ºä¾‹**:
```json
{
  "compressionStats": [
    {
      "name": "main.js",
      "originalSize": 204800,
      "gzipSize": 51200,
      "compressionRatio": 75.0,   // å‹ç¼©ç‡ 75%
      "category": "highly_compressible"
    },
    {
      "name": "logo.png",
      "originalSize": 51200,
      "gzipSize": 50176,
      "compressionRatio": 2.0,    // å‹ç¼©ç‡ä»… 2%
      "category": "already_compressed"
    }
  ],
  "summary": {
    "averageCompressionRatio": 68.5,
    "totalSavings": 358400        // æ€»å…±èŠ‚çœçš„å­—èŠ‚æ•°
  }
}
```

**åˆ†ç±»æ ‡å‡†**:
- å‹ç¼©ç‡ > 60%: é«˜åº¦å¯å‹ç¼©(æ–‡æœ¬æ–‡ä»¶)
- å‹ç¼©ç‡ 30-60%: ä¸­ç­‰å¯å‹ç¼©
- å‹ç¼©ç‡ < 30%: å·²å‹ç¼©æˆ–éš¾ä»¥å‹ç¼©(å›¾ç‰‡ã€å­—ä½“ã€è§†é¢‘)

**å®ç°æ–¹æ¡ˆ**:
- åˆ©ç”¨ç°æœ‰çš„ `Asset.size` å’Œ `Asset.gzip_size`
- è®¡ç®—å‹ç¼©ç‡å¹¶åˆ†ç±»

**æ€§èƒ½å½±å“**: âš¡ å‡ ä¹ä¸º 0 (< 1ms)

**å®ç°éš¾åº¦**: ğŸŸ¢ éå¸¸ç®€å•

---

### 5. æ¨¡å—è·¯å¾„ç»Ÿè®¡ â­â­â­â­

**åŠŸèƒ½è¯´æ˜**:
ç»Ÿè®¡æ¨¡å—è·¯å¾„çš„ç‰¹å¾,å¦‚ç›¸å¯¹è·¯å¾„æ·±åº¦ã€è·¯å¾„é•¿åº¦ã€è·¯å¾„åˆ«åä½¿ç”¨ç­‰ã€‚

**ä¸ºä»€ä¹ˆéœ€è¦**:
- å‘ç°è¿‡æ·±çš„ç›¸å¯¹è·¯å¾„å¼•ç”¨(å¦‚ `../../../utils/helper`)
- å»ºè®®ä½¿ç”¨è·¯å¾„åˆ«å(alias)ä¼˜åŒ–
- è¯†åˆ«è·¯å¾„è¿‡é•¿çš„æ¨¡å—(å¯èƒ½å½±å“å¯è¯»æ€§)

**æ•°æ®ç¤ºä¾‹**:
```json
{
  "pathStats": {
    "averagePathDepth": 3.5,
    "maxPathDepth": 7,
    "deepPaths": [
      {
        "module": "./src/components/deep/nested/very/deep/Component.tsx",
        "depth": 7,
        "suggestion": "è€ƒè™‘ä½¿ç”¨è·¯å¾„åˆ«å @components"
      }
    ],
    "relativeImports": {
      "count": 120,
      "averageDepth": 2.3
    },
    "absoluteImports": {
      "count": 45,
      "aliasUsage": 30        // ä½¿ç”¨äº†åˆ«åçš„å¯¼å…¥æ•°é‡
    }
  }
}
```

**å®ç°æ–¹æ¡ˆ**:
- è§£æ `Module.name` å­—æ®µ
- ç»Ÿè®¡ `../` çš„æ•°é‡(ç›¸å¯¹è·¯å¾„æ·±åº¦)
- ç»Ÿè®¡è·¯å¾„é•¿åº¦
- æ£€æµ‹æ˜¯å¦ä½¿ç”¨åˆ«å(è·¯å¾„ä¸åŒ…å« `./` æˆ– `../`)

**æ€§èƒ½å½±å“**: âš¡ å‡ ä¹ä¸º 0 (< 10ms)

**å®ç°éš¾åº¦**: ğŸŸ¢ ç®€å•

---

### 6. æ„å»ºä¼˜åŒ–å»ºè®®(åŸºç¡€ç‰ˆ) â­â­â­â­

**åŠŸèƒ½è¯´æ˜**:
åŸºäºç»Ÿè®¡æ•°æ®,è‡ªåŠ¨ç”Ÿæˆä¼˜åŒ–å»ºè®®ã€‚

**ä¸ºä»€ä¹ˆéœ€è¦**:
- è‡ªåŠ¨åŒ–å‘ç°æ€§èƒ½é—®é¢˜
- æä¾›å¯æ“ä½œçš„ä¼˜åŒ–æ–¹å‘
- é‡åŒ–ä¼˜åŒ–çš„æ½œåœ¨æ”¶ç›Š

**å»ºè®®ç±»å‹**:

#### 6.1 å¤§æ–‡ä»¶æ‹†åˆ†å»ºè®®
```json
{
  "type": "split-large-chunk",
  "severity": "high",
  "message": "Chunk 'main' å¤§å°ä¸º 850KB,è¶…è¿‡æ¨èçš„ 500KB",
  "suggestion": "è€ƒè™‘ä½¿ç”¨ splitChunks æ‹†åˆ†æˆ–å¯ç”¨æ‡’åŠ è½½",
  "potentialSavings": 350000,
  "affectedChunk": "main"
}
```

#### 6.2 é‡å¤ä¾èµ–å»ºè®®
```json
{
  "type": "duplicate-packages",
  "severity": "medium",
  "message": "æ£€æµ‹åˆ° lodash æœ‰ 2 ä¸ªç‰ˆæœ¬: 4.17.21, 4.17.19",
  "suggestion": "ç»Ÿä¸€ä¾èµ–ç‰ˆæœ¬ä»¥å‡å°‘åŒ…ä½“ç§¯",
  "potentialSavings": 72000,
  "packages": ["lodash@4.17.21", "lodash@4.17.19"]
}
```

#### 6.3 å·²å‹ç¼©èµ„æºå»ºè®®
```json
{
  "type": "skip-compression",
  "severity": "low",
  "message": "10 ä¸ªå›¾ç‰‡æ–‡ä»¶çš„ gzip å‹ç¼©ç‡ < 10%",
  "suggestion": "è¿™äº›æ–‡ä»¶å·²ç»æ˜¯å‹ç¼©æ ¼å¼,å¯ä»¥è·³è¿‡ gzip å‹ç¼©",
  "affectedFiles": ["logo.png", "banner.jpg", ...]
}
```

#### 6.4 ä¾èµ–è¿‡é‡å»ºè®®
```json
{
  "type": "heavy-dependencies",
  "severity": "high",
  "message": "ä¾èµ–ä»£ç å æ¯” 85%,ä¸šåŠ¡ä»£ç ä»… 15%",
  "suggestion": "æ£€æŸ¥æ˜¯å¦å¯ä»¥ä½¿ç”¨æ›´è½»é‡çš„æ›¿ä»£åº“",
  "heavyPackages": [
    { "name": "moment", "size": 524288, "alternative": "day.js (ä»… 2KB)" },
    { "name": "lodash", "size": 327680, "alternative": "lodash-es + tree shaking" }
  ]
}
```

**å®ç°æ–¹æ¡ˆ**:
- å®šä¹‰è§„åˆ™é˜ˆå€¼
- éå†æ•°æ®,åŒ¹é…è§„åˆ™ç”Ÿæˆå»ºè®®
- æŒ‰ä¸¥é‡ç¨‹åº¦æ’åº

**è§„åˆ™ç¤ºä¾‹**:
```rust
const RULES = [
  { type: "large_chunk", threshold: 500KB, severity: "high" },
  { type: "dependency_ratio", threshold: 0.8, severity: "medium" },
  { type: "compression_ratio", threshold: 10%, severity: "low" },
];
```

**æ€§èƒ½å½±å“**: âš¡ ä½ (< 20ms)

**å®ç°éš¾åº¦**: ğŸŸ¡ ä¸­ç­‰

---

## é«˜å¯è¡Œæ€§ + ä¸­ç­‰æ€§èƒ½å½±å“

è¿™äº›åŠŸèƒ½å¯è¡Œä½†æœ‰ä¸€å®šæ€§èƒ½æˆæœ¬,å»ºè®®åšæˆå¯é€‰åŠŸèƒ½ã€‚

### 7. Brotli å‹ç¼©å¤§å° â­â­â­â­

**åŠŸèƒ½è¯´æ˜**:
é™¤äº† gzip,é¢å¤–è®¡ç®— Brotli å‹ç¼©åçš„å¤§å°ã€‚

**ä¸ºä»€ä¹ˆéœ€è¦**:
- Brotli å‹ç¼©ç‡æ¯” gzip é«˜ 15-25%
- ç°ä»£æµè§ˆå™¨éƒ½æ”¯æŒ Brotli
- æ›´å‡†ç¡®è¯„ä¼°ç”Ÿäº§ç¯å¢ƒçš„ä¼ è¾“å¤§å°

**å¯¹æ¯”ç¤ºä¾‹**:
```json
{
  "name": "main.js",
  "originalSize": 204800,       // 200KB
  "gzipSize": 51200,            // 50KB (å‹ç¼©ç‡ 75%)
  "brotliSize": 40960,          // 40KB (å‹ç¼©ç‡ 80%)
  "brotliSavings": 10240        // æ¯” gzip å¤šèŠ‚çœ 10KB
}
```

**å…¸å‹å‹ç¼©ç‡å¯¹æ¯”**:
- JavaScript: gzip 70-75%, brotli 75-80%
- CSS: gzip 70-80%, brotli 75-85%
- HTML: gzip 65-70%, brotli 70-75%

**å®ç°æ–¹æ¡ˆ**:
- ä½¿ç”¨ `brotli` crate (ç±»ä¼¼ `flate2`)
- åœ¨ `collect_assets()` ä¸­å¹¶è¡Œè®¡ç®—
- é…ç½®é€‰é¡¹æ§åˆ¶æ˜¯å¦å¯ç”¨

```rust
pub struct BundleAnalyzerPluginOpts {
  pub enable_brotli: bool,  // é»˜è®¤ false
}
```

**æ€§èƒ½å½±å“**: âš¡âš¡ ä¸­ç­‰ (å¢åŠ  100-300ms)
- Brotli å‹ç¼©æ¯” gzip æ…¢ 2-5 å€
- ä½†å¯ä»¥é€šè¿‡å¹¶è¡Œå¤„ç†ä¼˜åŒ–

**ä¼˜åŒ–æ–¹æ¡ˆ**:
- ä½¿ç”¨ rayon å¹¶è¡Œè®¡ç®—
- åªå¯¹ > 10KB çš„æ–‡ä»¶è®¡ç®— brotli
- åšæˆå¯é€‰åŠŸèƒ½

**å®ç°éš¾åº¦**: ğŸŸ¢ ç®€å•

---

### 8. é‡å¤åŒ…æ£€æµ‹ â­â­â­â­

**åŠŸèƒ½è¯´æ˜**:
æ£€æµ‹åŒä¸€ä¸ªåŒ…çš„ä¸åŒç‰ˆæœ¬è¢«æ‰“åŒ…å¤šæ¬¡çš„æƒ…å†µã€‚

**ä¸ºä»€ä¹ˆéœ€è¦**:
- ç›¸åŒåŒ…çš„ä¸åŒç‰ˆæœ¬ä¼šå¢åŠ åŒ…ä½“ç§¯
- å¯èƒ½å¯¼è‡´è¿è¡Œæ—¶å†²çª
- ä¼˜åŒ–åå¯ä»¥æ˜¾è‘—å‡å°ä½“ç§¯

**æ•°æ®ç¤ºä¾‹**:
```json
{
  "duplicatePackages": [
    {
      "name": "lodash",
      "versions": [
        {
          "version": "4.17.21",
          "size": 327680,
          "moduleCount": 256,
          "usedBy": ["react-router", "redux-form"]
        },
        {
          "version": "4.17.19",
          "size": 319488,
          "moduleCount": 248,
          "usedBy": ["antd", "moment"]
        }
      ],
      "totalSize": 647168,
      "wastedSize": 319488,       // å¦‚æœç»Ÿä¸€ç‰ˆæœ¬å¯èŠ‚çœçš„å¤§å°
      "suggestion": "ç»Ÿä¸€åˆ° lodash@4.17.21"
    }
  ],
  "summary": {
    "duplicateCount": 5,
    "totalWastedSize": 1048576    // æ€»å…±æµªè´¹ 1MB
  }
}
```

**å®ç°æ–¹æ¡ˆ**:
- éå† `packages`,ç”¨ HashMap æŒ‰åŒ…ååˆ†ç»„
- å¦‚æœåŒååŒ…æœ‰å¤šä¸ªç‰ˆæœ¬,æ ‡è®°ä¸ºé‡å¤
- è®¡ç®—æµªè´¹çš„ç©ºé—´(é™¤äº†æœ€å¤§ç‰ˆæœ¬,å…¶ä»–éƒ½æ˜¯æµªè´¹)

```rust
HashMap<String, Vec<Package>>
// key: package name
// value: list of different versions
```

**æ€§èƒ½å½±å“**: âš¡ ä½ (< 20ms)

**å®ç°éš¾åº¦**: ğŸŸ¢ ç®€å•

---

### 9. å­¤ç«‹æ¨¡å—æ£€æµ‹ â­â­â­â­

**åŠŸèƒ½è¯´æ˜**:
æ£€æµ‹æ²¡æœ‰è¢«ä»»ä½•æ¨¡å—å¼•ç”¨çš„æ¨¡å—(å¯èƒ½æ˜¯æ­»ä»£ç )ã€‚

**ä¸ºä»€ä¹ˆéœ€è¦**:
- è¯†åˆ«æœªä½¿ç”¨çš„ä»£ç 
- æ¸…ç†å†—ä½™æ¨¡å—
- å‡å°åŒ…ä½“ç§¯

**ä»€ä¹ˆæ˜¯å­¤ç«‹æ¨¡å—**:
- æ²¡æœ‰è¢«å…¶ä»–æ¨¡å— import/require
- ä¸æ˜¯å…¥å£æ¨¡å—
- å¯èƒ½æ˜¯é—ç•™ä»£ç æˆ–æµ‹è¯•æ–‡ä»¶è¢«è¯¯æ‰“åŒ…

**æ•°æ®ç¤ºä¾‹**:
```json
{
  "orphanModules": [
    {
      "id": "123",
      "name": "./src/utils/old-helper.js",
      "size": 5120,
      "reason": "æ— å…¶ä»–æ¨¡å—å¼•ç”¨",
      "inChunks": ["main"],
      "suggestion": "è€ƒè™‘åˆ é™¤æ­¤æ¨¡å—"
    }
  ],
  "summary": {
    "orphanCount": 8,
    "totalSize": 40960,
    "potentialSavings": 40960
  }
}
```

**æ³¨æ„äº‹é¡¹**:
- å…¥å£æ¨¡å—ä¸ç®—å­¤ç«‹æ¨¡å—
- æœ‰å‰¯ä½œç”¨çš„æ¨¡å—å¯èƒ½æœ‰æ„è¢«ä¿ç•™

**å®ç°æ–¹æ¡ˆ**:
- éå† module_graph,ç»Ÿè®¡æ¯ä¸ªæ¨¡å—çš„å¼•ç”¨æ¬¡æ•°
- å¼•ç”¨æ¬¡æ•°ä¸º 0 ä¸”ä¸æ˜¯å…¥å£çš„æ¨¡å—ä¸ºå­¤ç«‹æ¨¡å—

```rust
// ä¼ªä»£ç 
let mut ref_counts = HashMap::new();
for module in modules {
  for dep in module.dependencies {
    ref_counts.entry(dep.id).or_insert(0) += 1;
  }
}
// ref_count == 0 ä¸”ä¸æ˜¯ entry -> orphan
```

**æ€§èƒ½å½±å“**: âš¡ ä½åˆ°ä¸­ç­‰ (20-50ms)
- éœ€è¦éå†æ¨¡å—çš„ä¾èµ–å…³ç³»

**å®ç°éš¾åº¦**: ğŸŸ¡ ä¸­ç­‰

---

## ä¸­ç­‰å¯è¡Œæ€§ + è¾ƒé«˜æ€§èƒ½å½±å“

è¿™äº›åŠŸèƒ½å®ç°å¤æ‚æˆ–æ€§èƒ½æˆæœ¬è¾ƒé«˜,å»ºè®®åšæˆç‹¬ç«‹æ’ä»¶æˆ–å¯é€‰çš„æ·±åº¦åˆ†æåŠŸèƒ½ã€‚

### 10. æ¨¡å—ä¾èµ–å›¾ â­â­â­

**åŠŸèƒ½è¯´æ˜**:
è®°å½•æ¨¡å—ä¹‹é—´çš„å®Œæ•´ä¾èµ–å…³ç³»å›¾ã€‚

**ä¸ºä»€ä¹ˆéœ€è¦**:
- å¯è§†åŒ–æ¨¡å—ä¾èµ–
- åˆ†æä»£ç è€¦åˆåº¦
- æ‰¾åˆ°å…³é”®æ¨¡å—(è¢«å¾ˆå¤šæ¨¡å—ä¾èµ–)

**æ•°æ®ç¤ºä¾‹**:
```json
{
  "dependencyGraph": {
    "nodes": [
      {
        "id": "src/index.js",
        "size": 2048,
        "type": "entry"
      },
      {
        "id": "src/utils/helper.js",
        "size": 1024,
        "type": "utility"
      }
    ],
    "edges": [
      {
        "from": "src/index.js",
        "to": "src/utils/helper.js",
        "type": "import"
      }
    ]
  },
  "insights": {
    "mostDepended": {
      "module": "src/utils/helper.js",
      "dependentCount": 25      // è¢« 25 ä¸ªæ¨¡å—ä¾èµ–
    },
    "deepestChain": {
      "depth": 8,
      "chain": ["entry", "A", "B", "C", "D", "E", "F", "G"]
    }
  }
}
```

**é—®é¢˜**:
- **æ•°æ®é‡å·¨å¤§**: 1000 ä¸ªæ¨¡å—å¯èƒ½æœ‰ 5000+ æ¡ä¾èµ–å…³ç³»
- **æ€§èƒ½å½±å“**: éœ€è¦éå†æ‰€æœ‰æ¨¡å—çš„æ‰€æœ‰ä¾èµ–
- **å¯ç”¨æ€§**: å®Œæ•´ä¾èµ–å›¾æ•°æ®å¤ªå¤§,å‰ç«¯éš¾ä»¥æ¸²æŸ“

**å®ç°æ–¹æ¡ˆ**:
1. **ä»…è®°å½•ç›´æ¥ä¾èµ–** (æ¨è)
   - æ¯ä¸ªæ¨¡å—åªè®°å½•å®ƒç›´æ¥å¯¼å…¥çš„æ¨¡å—
   - ä¸è®°å½•ä¼ é€’ä¾èµ–
   - æ•°æ®é‡å¯æ§

2. **æ·±åº¦é™åˆ¶**
   - åªè®°å½• depth â‰¤ 3 çš„ä¾èµ–é“¾
   - è¶…è¿‡ 3 å±‚çš„ä¾èµ–ä¸è®°å½•

3. **æŒ‰éœ€æŸ¥è¯¢**
   - æä¾› API,æŒ‰æ¨¡å— ID æŸ¥è¯¢å…¶ä¾èµ–
   - ä¸ä¸€æ¬¡æ€§è¾“å‡ºæ‰€æœ‰ä¾èµ–

**æ€§èƒ½å½±å“**: âš¡âš¡âš¡ ä¸­ç­‰åˆ°é«˜ (100-500ms)
- å–å†³äºé¡¹ç›®è§„æ¨¡å’Œå®ç°æ–¹å¼

**å®ç°éš¾åº¦**: ğŸŸ¡ ä¸­ç­‰

**å»ºè®®**: åšæˆå¯é€‰åŠŸèƒ½,é»˜è®¤å…³é—­

---

### 11. å¾ªç¯ä¾èµ–æ£€æµ‹ â­â­â­

**åŠŸèƒ½è¯´æ˜**:
æ£€æµ‹æ¨¡å—ä¹‹é—´çš„å¾ªç¯ä¾èµ–é“¾ã€‚

**ä¸ºä»€ä¹ˆéœ€è¦**:
- å¾ªç¯ä¾èµ–å¯èƒ½å¯¼è‡´è¿è¡Œæ—¶é”™è¯¯
- å½±å“ tree shaking æ•ˆæœ
- ä»£ç è´¨é‡é—®é¢˜

**ä»€ä¹ˆæ˜¯å¾ªç¯ä¾èµ–**:
```
A imports B
B imports C
C imports A  â† å½¢æˆå¾ªç¯: A â†’ B â†’ C â†’ A
```

**æ•°æ®ç¤ºä¾‹**:
```json
{
  "circularDependencies": [
    {
      "cycle": [
        "src/components/A.tsx",
        "src/components/B.tsx",
        "src/utils/C.js",
        "src/components/A.tsx"
      ],
      "length": 3,
      "severity": "high"
    }
  ],
  "summary": {
    "cycleCount": 5,
    "affectedModules": 12
  }
}
```

**å®ç°æ–¹æ¡ˆ**:
- ä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢(DFS)æ£€æµ‹ç¯
- ç®—æ³•: Tarjan å¼ºè¿é€šåˆ†é‡ç®—æ³•

```rust
// ä¼ªä»£ç 
fn detect_cycles(graph: &Graph) -> Vec<Vec<ModuleId>> {
  let mut visited = HashSet::new();
  let mut stack = Vec::new();
  let mut cycles = Vec::new();

  for node in graph.nodes {
    if !visited.contains(node) {
      dfs(node, &mut visited, &mut stack, &mut cycles);
    }
  }

  cycles
}
```

**æ€§èƒ½å½±å“**: âš¡âš¡âš¡âš¡ é«˜ (200ms - 2s)
- DFS åœ¨å¤§å›¾ä¸Šå¯èƒ½å¾ˆæ…¢
- æœ€åæƒ…å†µ O(V + E),V æ˜¯æ¨¡å—æ•°,E æ˜¯ä¾èµ–æ•°

**å®ç°éš¾åº¦**: ğŸŸ¡ ä¸­ç­‰

**å»ºè®®**:
- åšæˆç‹¬ç«‹æ’ä»¶(ç±»ä¼¼ `spack_plugin_deadcode`)
- æˆ–è€…åšæˆå¯é€‰çš„æ·±åº¦åˆ†æåŠŸèƒ½

---

### 12. Tree Shaking æ•ˆæœåˆ†æ â­â­

**åŠŸèƒ½è¯´æ˜**:
åˆ†æå“ªäº›å¯¼å‡ºè¢«ä½¿ç”¨,å“ªäº›å¯¼å‡ºæ˜¯æ­»ä»£ç ã€‚

**ä¸ºä»€ä¹ˆéœ€è¦**:
- è¯„ä¼° tree shaking çš„æ•ˆæœ
- è¯†åˆ«æœªè¢«ä½¿ç”¨ä½†ä»è¢«æ‰“åŒ…çš„ä»£ç 
- ä¼˜åŒ–å¯¼å‡ºç»“æ„

**ç¤ºä¾‹åœºæ™¯**:
```javascript
// utils.js å¯¼å‡º 10 ä¸ªå‡½æ•°
export { fn1, fn2, fn3, ..., fn10 };

// ä½†åªæœ‰ fn1 å’Œ fn2 è¢«ä½¿ç”¨
// fn3-fn10 åº”è¯¥è¢« tree shaking ç§»é™¤
```

**æ•°æ®ç¤ºä¾‹**:
```json
{
  "treeShakingAnalysis": {
    "modules": [
      {
        "name": "src/utils.js",
        "exports": 10,
        "usedExports": 2,
        "unusedExports": ["fn3", "fn4", ..., "fn10"],
        "unusedSize": 8192,
        "shakeability": "20%"      // åªæœ‰ 20% è¢«ä½¿ç”¨
      }
    ],
    "summary": {
      "totalUnusedSize": 102400,  // 100KB æœªä½¿ç”¨çš„å¯¼å‡º
      "potentialSavings": 102400
    }
  }
}
```

**æŒ‘æˆ˜**:
- **éœ€è¦ AST åˆ†æ**: è§£ææ¯ä¸ªæ¨¡å—çš„å¯¼å‡ºå’Œå¯¼å…¥
- **æ€§èƒ½å½±å“æå¤§**: éœ€è¦è§£ææ‰€æœ‰æ¨¡å—çš„ AST
- **rspack å†…éƒ¨ä¿¡æ¯**: tree shaking å·²ç»åœ¨ rspack å†…éƒ¨å®Œæˆ,ç»“æœå¯èƒ½ä¸æš´éœ²

**å®ç°éš¾åº¦**: ğŸ”´ å›°éš¾

**æ€§èƒ½å½±å“**: âš¡âš¡âš¡âš¡âš¡ éå¸¸é«˜ (å¯èƒ½å¢åŠ  50%+ æ„å»ºæ—¶é—´)

**å»ºè®®**:
- ä¸é€‚åˆåœ¨ bundle analyzer ä¸­å®ç°
- æ›´é€‚åˆåšæˆç‹¬ç«‹çš„é™æ€åˆ†æå·¥å…·
- æˆ–è€…ä¾èµ– rspack å†…éƒ¨çš„ tree shaking ç»Ÿè®¡(å¦‚æœæœ‰æš´éœ²)

---

## ä½å¯è¡Œæ€§æˆ–ä¾èµ–å¤–éƒ¨æ•°æ®

è¿™äº›åŠŸèƒ½ä¾èµ–å¤–éƒ¨æ•°æ®æˆ–å®ç°è¿‡äºå¤æ‚,ä¸æ¨èåœ¨ bundle analyzer ä¸­å®ç°ã€‚

### 13. å†å²è¶‹åŠ¿å¯¹æ¯” â­â­â­

**åŠŸèƒ½è¯´æ˜**:
å¯¹æ¯”å½“å‰æ„å»ºå’Œå†å²æ„å»ºçš„å·®å¼‚,è·Ÿè¸ªåŒ…ä½“ç§¯å˜åŒ–è¶‹åŠ¿ã€‚

**ä¸ºä»€ä¹ˆéœ€è¦**:
- ç›‘æ§åŒ…ä½“ç§¯æ˜¯å¦æŒç»­å¢é•¿
- è¯†åˆ«å“ªæ¬¡æäº¤å¯¼è‡´åŒ…ä½“ç§¯æ¿€å¢
- å‘ç°æ€§èƒ½å›å½’

**æ•°æ®ç¤ºä¾‹**:
```json
{
  "comparison": {
    "current": {
      "timestamp": 1704931200000,
      "totalSize": 1048576,
      "chunkCount": 15
    },
    "previous": {
      "timestamp": 1704844800000,
      "totalSize": 942080,
      "chunkCount": 14
    },
    "changes": {
      "sizeDelta": 106496,        // +104KB
      "sizeChange": "+11.3%",
      "newChunks": ["lazy-route-5"],
      "removedChunks": [],
      "modifiedChunks": [
        {
          "name": "main",
          "oldSize": 524288,
          "newSize": 614400,
          "delta": 90112,         // +88KB
          "change": "+17.2%"
        }
      ]
    }
  }
}
```

**æŒ‘æˆ˜**:
- **éœ€è¦æŒä¹…åŒ–**: å¿…é¡»å­˜å‚¨å†å²æ„å»ºæ•°æ®
- **å­˜å‚¨æ–¹æ¡ˆ**: æ–‡ä»¶ç³»ç»Ÿã€æ•°æ®åº“ã€äº‘å­˜å‚¨?
- **ç‰ˆæœ¬ç®¡ç†**: å¦‚ä½•å…³è” git commit?
- **æ•°æ®æ¸…ç†**: ä¿ç•™å¤šå°‘å†å²è®°å½•?

**å®ç°æ–¹æ¡ˆ**:
1. **ç”¨æˆ·è‡ªè¡Œå­˜å‚¨**
   - æ’ä»¶åªç”Ÿæˆ report
   - ç”¨æˆ·è‡ªå·±ä¿å­˜å†å² report
   - å¯¹æ¯”é€»è¾‘åœ¨ JS å±‚å®ç°

2. **æ–‡ä»¶å­˜å‚¨**
   ```
   .spack-history/
   â”œâ”€â”€ 2024-01-10-build-1.json
   â”œâ”€â”€ 2024-01-10-build-2.json
   â””â”€â”€ 2024-01-11-build-1.json
   ```

**æ€§èƒ½å½±å“**: âš¡ ä½ (è¯»å–å†å²æ–‡ä»¶ < 50ms)

**å®ç°éš¾åº¦**: ğŸŸ¡ ä¸­ç­‰ (ä¸»è¦æ˜¯æ¶æ„è®¾è®¡)

**å»ºè®®**:
- åœ¨ JS å±‚å®ç°,ä¸åœ¨ Rust æ’ä»¶ä¸­å®ç°
- æä¾›å·¥å…·å‡½æ•°,è®©ç”¨æˆ·è‡ªå·±å¯¹æ¯”å†å²æ•°æ®

---

### 14. è®¸å¯è¯ä¿¡æ¯ç»Ÿè®¡ â­â­

**åŠŸèƒ½è¯´æ˜**:
ç»Ÿè®¡æ¯ä¸ªä¾èµ–åŒ…çš„å¼€æºè®¸å¯è¯ç±»å‹ã€‚

**ä¸ºä»€ä¹ˆéœ€è¦**:
- åˆè§„æ€§æ£€æŸ¥(é¿å…ä½¿ç”¨ä¸å…¼å®¹çš„è®¸å¯è¯)
- è¯†åˆ«å•†ä¸šè®¸å¯è¯
- ç”Ÿæˆè®¸å¯è¯å£°æ˜æ–‡ä»¶

**æ•°æ®ç¤ºä¾‹**:
```json
{
  "licenses": [
    {
      "package": "react",
      "version": "18.2.0",
      "license": "MIT",
      "riskLevel": "low"
    },
    {
      "package": "some-lib",
      "version": "1.0.0",
      "license": "GPL-3.0",
      "riskLevel": "high",        // GPL è¦æ±‚å¼€æº
      "warning": "GPL è®¸å¯è¯è¦æ±‚é¡¹ç›®ä¹Ÿå¼€æº"
    }
  ],
  "summary": {
    "MIT": 120,
    "Apache-2.0": 15,
    "GPL-3.0": 2,
    "Unknown": 5
  }
}
```

**æŒ‘æˆ˜**:
- **å¤§é‡ I/O**: éœ€è¦è¯»å–æ¯ä¸ªåŒ…çš„ `package.json`
- **è·¯å¾„è§£æ**: æ‰¾åˆ° node_modules ä¸­çš„ package.json
- **è®¸å¯è¯ä¸è§„èŒƒ**: æœ‰äº›åŒ…æ²¡æœ‰ license å­—æ®µ,æˆ–è€…æ ¼å¼ä¸æ ‡å‡†
- **æ€§èƒ½å½±å“**: è¯»å–æ•°ç™¾ä¸ªæ–‡ä»¶å¾ˆæ…¢

**å®ç°æ–¹æ¡ˆ**:
```rust
// ä¼ªä»£ç 
for package in packages {
  let package_json_path = resolve_package_json(&package.name);
  let license = read_license(package_json_path);
}
```

**æ€§èƒ½å½±å“**: âš¡âš¡âš¡âš¡ é«˜ (200-800ms)
- å–å†³äºä¾èµ–æ•°é‡
- æ–‡ä»¶ I/O æ˜¯ä¸»è¦ç“¶é¢ˆ

**å®ç°éš¾åº¦**: ğŸŸ¡ ä¸­ç­‰

**å»ºè®®**:
- ä½¿ç”¨ç°æœ‰çš„ä¸“ä¸šå·¥å…·: `license-checker`, `yarn licenses`
- ä¸åœ¨ bundle analyzer ä¸­é‡å¤å®ç°

---

### 15. å®‰å…¨æ¼æ´æ£€æµ‹ â­

**åŠŸèƒ½è¯´æ˜**:
æ£€æµ‹ä¾èµ–åŒ…ä¸­çš„å·²çŸ¥å®‰å…¨æ¼æ´ã€‚

**ä¸ºä»€ä¹ˆéœ€è¦**:
- é¿å…ä½¿ç”¨æœ‰æ¼æ´çš„ä¾èµ–
- åˆè§„æ€§è¦æ±‚
- æå‡åº”ç”¨å®‰å…¨æ€§

**æ•°æ®ç¤ºä¾‹**:
```json
{
  "vulnerabilities": [
    {
      "package": "lodash",
      "version": "4.17.19",
      "severity": "high",
      "cve": "CVE-2020-8203",
      "description": "Prototype Pollution",
      "recommendation": "å‡çº§åˆ° 4.17.21"
    }
  ],
  "summary": {
    "critical": 0,
    "high": 2,
    "medium": 5,
    "low": 8
  }
}
```

**æŒ‘æˆ˜**:
- **éœ€è¦æ¼æ´æ•°æ®åº“**: å¿…é¡»æŸ¥è¯¢å¤–éƒ¨ API æˆ–æ•°æ®åº“
- **ç½‘ç»œè¯·æ±‚**: æŸ¥è¯¢ npm advisory API æˆ– Snyk API
- **æ€§èƒ½å½±å“å·¨å¤§**: ç½‘ç»œè¯·æ±‚å¾ˆæ…¢
- **éœ€è¦è®¤è¯**: æŸäº› API éœ€è¦ token

**å®ç°éš¾åº¦**: ğŸ”´ å›°éš¾

**æ€§èƒ½å½±å“**: âš¡âš¡âš¡âš¡âš¡ éå¸¸é«˜ (å–å†³äºç½‘ç»œ,å¯èƒ½æ•°ç§’)

**å»ºè®®**:
- ä½¿ç”¨ä¸“ä¸šå·¥å…·: `npm audit`, `yarn audit`, `snyk`
- ä¸åœ¨ bundle analyzer ä¸­å®ç°

---

### 16. Web Vitals å½±å“é¢„ä¼° â­

**åŠŸèƒ½è¯´æ˜**:
é¢„ä¼°åŒ…ä½“ç§¯å¯¹ Web Vitals æŒ‡æ ‡(FCP, LCP, TBT)çš„å½±å“ã€‚

**ä¸ºä»€ä¹ˆéœ€è¦**:
- å…³è”æ„å»ºäº§ç‰©å’Œç”¨æˆ·ä½“éªŒ
- é‡åŒ–æ€§èƒ½ä¼˜åŒ–çš„æ•ˆæœ
- ç¬¦åˆ Google çš„æ€§èƒ½æ ‡å‡†

**Web Vitals æŒ‡æ ‡**:
- **FCP** (First Contentful Paint): é¦–æ¬¡å†…å®¹ç»˜åˆ¶
- **LCP** (Largest Contentful Paint): æœ€å¤§å†…å®¹ç»˜åˆ¶
- **TBT** (Total Blocking Time): æ€»é˜»å¡æ—¶é—´

**æ•°æ®ç¤ºä¾‹**:
```json
{
  "webVitalsEstimate": {
    "FCP": {
      "estimatedTime": 1200,      // 1.2ç§’
      "rating": "good",           // good/needs-improvement/poor
      "å½±å“å› ç´ ": "é¦–å± JS ä½“ç§¯ 150KB"
    },
    "LCP": {
      "estimatedTime": 2100,      // 2.1ç§’
      "rating": "needs-improvement"
    },
    "TBT": {
      "estimatedTime": 350,       // 350ms
      "rating": "good"
    }
  }
}
```

**æŒ‘æˆ˜**:
- **é¢„ä¼°ä¸å‡†ç¡®**: å—ç½‘ç»œé€Ÿåº¦ã€è®¾å¤‡æ€§èƒ½ã€ä»£ç æ‰§è¡Œç­‰å¤šç§å› ç´ å½±å“
- **éœ€è¦å¤§é‡æ•°æ®**: éœ€è¦çœŸå®ç”¨æˆ·ç›‘æ§(RUM)æ•°æ®
- **å¤æ‚çš„ç®—æ³•**: éœ€è¦æœºå™¨å­¦ä¹ æˆ–å¯å‘å¼ç®—æ³•
- **åªæ˜¯æ„å»ºæ—¶ä¿¡æ¯**: ç¼ºä¹è¿è¡Œæ—¶è¡Œä¸º

**å®ç°éš¾åº¦**: ğŸ”´ éå¸¸å›°éš¾

**æ€§èƒ½å½±å“**: âš¡âš¡âš¡ ä¸­ç­‰

**å»ºè®®**:
- ä¸é€‚åˆåœ¨æ„å»ºå·¥å…·ä¸­å®ç°
- åº”è¯¥ç”¨çœŸå®çš„æ€§èƒ½ç›‘æ§å·¥å…·: Lighthouse, WebPageTest, Chrome UX Report

---

### 17. åŠ è½½æ€§èƒ½æŒ‡æ ‡(å…³é”®è·¯å¾„) â­â­

**åŠŸèƒ½è¯´æ˜**:
è¯†åˆ«æ¸²æŸ“å…³é”®è·¯å¾„ä¸Šçš„æ¨¡å—,åŒºåˆ†å…³é”®å’Œéå…³é”®èµ„æºã€‚

**ä¸ºä»€ä¹ˆéœ€è¦**:
- ä¼˜åŒ–é¦–å±åŠ è½½
- å»¶è¿ŸåŠ è½½éå…³é”®èµ„æº
- æå‡ FCP/LCP

**ä»€ä¹ˆæ˜¯å…³é”®è·¯å¾„**:
- ä» HTML åˆ°é¦–æ¬¡æ¸²æŸ“å¿…é¡»çš„èµ„æºé“¾
- åŒ…æ‹¬: HTML â†’ åŒæ­¥ JS â†’ åŒæ­¥ CSS â†’ é¦–å±ç»„ä»¶

**æ•°æ®ç¤ºä¾‹**:
```json
{
  "criticalPath": {
    "criticalModules": [
      {
        "name": "src/index.js",
        "size": 2048,
        "reason": "entry point"
      },
      {
        "name": "src/App.tsx",
        "size": 10240,
        "reason": "é¦–å±ç»„ä»¶"
      }
    ],
    "nonCriticalModules": [
      {
        "name": "src/routes/Admin.tsx",
        "size": 20480,
        "reason": "æ‡’åŠ è½½è·¯ç”±"
      }
    ],
    "criticalSize": 153600,       // 150KB (å…³é”®è·¯å¾„)
    "nonCriticalSize": 409600     // 400KB (å¯å»¶è¿Ÿ)
  }
}
```

**æŒ‘æˆ˜**:
- **éœ€è¦è¿è¡Œæ—¶ä¿¡æ¯**: å“ªäº›ç»„ä»¶æ˜¯é¦–å±æ¸²æŸ“çš„?
- **ä¾èµ–æ¡†æ¶**: React/Vue/Angular çš„æ¸²æŸ“è¡Œä¸ºä¸åŒ
- **åŠ¨æ€è¡Œä¸º**: è·¯ç”±ã€æ¡ä»¶æ¸²æŸ“ç­‰è¿è¡Œæ—¶å†³å®š

**å®ç°éš¾åº¦**: ğŸ”´ å›°éš¾

**æ€§èƒ½å½±å“**: âš¡âš¡âš¡ ä¸­ç­‰åˆ°é«˜

**å»ºè®®**:
- éœ€è¦ç»“åˆè¿è¡Œæ—¶åˆ†æ(å¦‚ React DevTools Profiler)
- ä¸é€‚åˆåœ¨çº¯æ„å»ºæ—¶å®ç°

---

## æ€§èƒ½å½±å“æ€»ç»“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ€§èƒ½å½±å“åˆ†çº§                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš¡ å‡ ä¹æ— å½±å“ (< 10ms)                                â”‚
â”‚ â”œâ”€ æ–‡ä»¶ç±»å‹åˆ†å¸ƒ                                       â”‚
â”‚ â”œâ”€ æºç  vs ä¾èµ–æ¯”ä¾‹                                   â”‚
â”‚ â”œâ”€ Chunk åˆ†ç»„ç»Ÿè®¡                                     â”‚
â”‚ â”œâ”€ å‹ç¼©ç‡ç»Ÿè®¡                                         â”‚
â”‚ â””â”€ æ¨¡å—è·¯å¾„ç»Ÿè®¡                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš¡âš¡ ä½å½±å“ (10-50ms)                                â”‚
â”‚ â”œâ”€ é‡å¤åŒ…æ£€æµ‹                                         â”‚
â”‚ â”œâ”€ å­¤ç«‹æ¨¡å—æ£€æµ‹                                       â”‚
â”‚ â””â”€ æ„å»ºä¼˜åŒ–å»ºè®®                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš¡âš¡âš¡ ä¸­ç­‰å½±å“ (50-200ms)                           â”‚
â”‚ â”œâ”€ Brotli å‹ç¼© (å¯å¹¶è¡Œä¼˜åŒ–)                           â”‚
â”‚ â”œâ”€ æ¨¡å—ä¾èµ–å›¾(æµ…å±‚)                                   â”‚
â”‚ â””â”€ è®¸å¯è¯ä¿¡æ¯                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš¡âš¡âš¡âš¡ é«˜å½±å“ (200ms+)                             â”‚
â”‚ â”œâ”€ æ¨¡å—ä¾èµ–å›¾(æ·±å±‚)                                   â”‚
â”‚ â”œâ”€ å¾ªç¯ä¾èµ–æ£€æµ‹                                       â”‚
â”‚ â””â”€ å®‰å…¨æ¼æ´æ£€æµ‹(ç½‘ç»œè¯·æ±‚)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš¡âš¡âš¡âš¡âš¡ éå¸¸é«˜å½±å“ (å¯èƒ½ 50%+ æ„å»ºæ—¶é—´)          â”‚
â”‚ â””â”€ Tree Shaking æ•ˆæœåˆ†æ                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ¨èå®ç°æ¸…å•

### ğŸš€ ç¬¬ä¸€æ‰¹: ç«‹å³å®ç° (å‡ ä¹æ— æ€§èƒ½æŸè€—)

è¿™äº›åŠŸèƒ½ç¡®å®šæ€§å¼ºã€å®ç°ç®€å•ã€å¯¹ç”¨æˆ·ä»·å€¼é«˜,å»ºè®®ä¼˜å…ˆå®ç°:

1. âœ… **æ–‡ä»¶ç±»å‹åˆ†å¸ƒ** - å¿«é€Ÿäº†è§£èµ„æºç»„æˆ
2. âœ… **æºç  vs ä¾èµ–æ¯”ä¾‹** - è¯„ä¼°ä»£ç è†¨èƒ€
3. âœ… **Chunk åˆ†ç»„ç»Ÿè®¡** - ä¼˜åŒ–ä»£ç åˆ†å‰²
4. âœ… **å‹ç¼©ç‡ç»Ÿè®¡** - è¯†åˆ«å‹ç¼©æ•ˆæœ
5. âœ… **é‡å¤åŒ…æ£€æµ‹** - å‡å°‘å†—ä½™ä¾èµ–

**é¢„ä¼°æ€»æ€§èƒ½å½±å“**: < 50ms

---

### âš™ï¸ ç¬¬äºŒæ‰¹: å¯é€‰åŠŸèƒ½ (éœ€è¦é…ç½®é¡¹æ§åˆ¶)

è¿™äº›åŠŸèƒ½æœ‰ä¸€å®šæ€§èƒ½æˆæœ¬,å»ºè®®åšæˆå¯é€‰,é»˜è®¤å…³é—­:

6. âš™ï¸ **Brotli å‹ç¼©** - é€šè¿‡ `enable_brotli` é…ç½®é¡¹æ§åˆ¶
7. âš™ï¸ **æ¨¡å—ä¾èµ–å›¾(ä»…ç›´æ¥ä¾èµ–)** - é€šè¿‡ `enable_dependency_graph` æ§åˆ¶
8. âš™ï¸ **å­¤ç«‹æ¨¡å—æ£€æµ‹** - é€šè¿‡ `enable_orphan_detection` æ§åˆ¶
9. âš™ï¸ **æ„å»ºä¼˜åŒ–å»ºè®®** - é€šè¿‡ `enable_suggestions` æ§åˆ¶

**é…ç½®ç¤ºä¾‹**:
```rust
pub struct BundleAnalyzerPluginOpts {
  pub on_analyzed: Option<CompilationHookFn>,
  pub enable_brotli: bool,              // é»˜è®¤ false
  pub enable_dependency_graph: bool,     // é»˜è®¤ false
  pub enable_orphan_detection: bool,     // é»˜è®¤ false
  pub enable_suggestions: bool,          // é»˜è®¤ true
}
```

---

### ğŸ”Œ ç¬¬ä¸‰æ‰¹: ç‹¬ç«‹æ’ä»¶

è¿™äº›åŠŸèƒ½æ€§èƒ½å½±å“å¤§æˆ–åŠŸèƒ½ç‹¬ç«‹,å»ºè®®åšæˆå•ç‹¬çš„æ’ä»¶:

9. ğŸ”Œ **å¾ªç¯ä¾èµ–æ£€æµ‹** â†’ `spack_plugin_circular_dependency`
10. ğŸ”Œ **Tree Shaking åˆ†æ** â†’ ç‹¬ç«‹å·¥å…·æˆ–ä¾èµ– rspack å†…éƒ¨ç»Ÿè®¡

---

### âŒ ä¸æ¨èå®ç°

è¿™äº›åŠŸèƒ½åº”è¯¥ä½¿ç”¨ç°æœ‰çš„ä¸“ä¸šå·¥å…·:

- âŒ **å®‰å…¨æ¼æ´æ£€æµ‹** â†’ ä½¿ç”¨ `npm audit` / `snyk`
- âŒ **è®¸å¯è¯ä¿¡æ¯** â†’ ä½¿ç”¨ `license-checker`
- âŒ **Web Vitals é¢„ä¼°** â†’ ä½¿ç”¨ Lighthouse / WebPageTest
- âŒ **å…³é”®è·¯å¾„åˆ†æ** â†’ éœ€è¦è¿è¡Œæ—¶åˆ†æå·¥å…·

---

## é™„å½•: æ•°æ®ç»“æ„å®šä¹‰

### FileTypeStats
```rust
pub struct FileTypeStats {
  pub file_type: String,          // "JavaScript", "CSS", "Image", "Font"
  pub extensions: Vec<String>,    // [".js", ".mjs"]
  pub count: usize,               // æ–‡ä»¶æ•°é‡
  pub total_size: u64,            // æ€»å¤§å°
  pub gzip_size: Option<u64>,     // gzip æ€»å¤§å°
  pub brotli_size: Option<u64>,   // brotli æ€»å¤§å°(å¯é€‰)
  pub percentage: f64,            // å æ€»å¤§å°çš„ç™¾åˆ†æ¯”
}
```

### CodeDistribution
```rust
pub struct CodeDistribution {
  pub source_code: CodeCategory,
  pub dependencies: CodeCategory,
  pub ratio: f64,                 // source / dependencies
}

pub struct CodeCategory {
  pub size: u64,
  pub module_count: usize,
  pub percentage: f64,
}
```

### ChunkGroups
```rust
pub struct ChunkGroups {
  pub entry: ChunkGroup,
  pub initial: ChunkGroup,
  pub async_chunks: ChunkGroup,
  pub runtime: ChunkGroup,
}

pub struct ChunkGroup {
  pub count: usize,
  pub total_size: u64,
  pub chunk_ids: Vec<String>,
}
```

### DuplicatePackage
```rust
pub struct DuplicatePackage {
  pub name: String,
  pub versions: Vec<PackageVersion>,
  pub total_size: u64,
  pub wasted_size: u64,           // å¦‚æœç»Ÿä¸€ç‰ˆæœ¬å¯èŠ‚çœçš„å¤§å°
  pub suggestion: String,
}

pub struct PackageVersion {
  pub version: String,
  pub size: u64,
  pub module_count: usize,
  pub used_by: Vec<String>,       // å“ªäº›åŒ…ä¾èµ–äº†è¿™ä¸ªç‰ˆæœ¬
}
```

### OptimizationSuggestion
```rust
pub struct OptimizationSuggestion {
  pub suggestion_type: String,    // "split-chunk", "duplicate-package", etc.
  pub severity: String,           // "high", "medium", "low"
  pub message: String,
  pub suggestion: String,
  pub potential_savings: u64,     // æ½œåœ¨èŠ‚çœçš„å­—èŠ‚æ•°
  pub affected_items: Vec<String>,
}
```

---

## è´¡çŒ®æŒ‡å—

å¦‚æœä½ æƒ³å®ç°è¿™äº›åŠŸèƒ½,å»ºè®®çš„æ­¥éª¤:

1. **ä»ç¬¬ä¸€æ‰¹å¼€å§‹** - è¿™äº›åŠŸèƒ½æœ€å®¹æ˜“å®ç°ä¸”ä»·å€¼é«˜
2. **æ·»åŠ æµ‹è¯•** - ä¸ºæ–°åŠŸèƒ½ç¼–å†™å•å…ƒæµ‹è¯•
3. **æ€§èƒ½åŸºå‡†æµ‹è¯•** - ç¡®ä¿æ€§èƒ½å½±å“åœ¨å¯æ¥å—èŒƒå›´å†…
4. **æ–‡æ¡£æ›´æ–°** - æ›´æ–° README å’Œ API æ–‡æ¡£
5. **å¯é€‰åŠŸèƒ½è®¾è®¡** - æ€§èƒ½å½±å“è¾ƒå¤§çš„åŠŸèƒ½å¿…é¡»å¯é…ç½®

---

*æœ€åæ›´æ–°: 2024-01-15*
